pipeline {
    agent any
    
    stages {  
        stage('Load Environment Variables') {
            steps {
                withCredentials([file(credentialsId: 'env-file', variable: 'ENV_FILE')]) {
                    sh '''
                        cp "${ENV_FILE}" .env || { echo "Failed to copy .env"; exit 1; }
                        chmod 644 .env
                        ls -la .env  # Verify
                    '''
                }
            }
        }
    }
}